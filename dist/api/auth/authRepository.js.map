{"version":3,"sources":["../../../src/api/auth/authRepository.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nimport bcrypt from \"bcrypt\";\n\nconst prisma = new PrismaClient();\n\nexport class AuthRepository {\n  async createUser({ username, email, password }: { username: string; email: string; password: string }) {\n    const hashedPassword = await bcrypt.hash(password, 10);\n    return prisma.user.create({\n      data: {\n        username,\n        email,\n        password: hashedPassword,\n      },\n    });\n  }\n\n  async findUserByUsername(username: string) {\n    return prisma.user.findUnique({\n      where: { username },\n    });\n  }\n\n  async findUserById(userId: string) {\n    return prisma.user.findUnique({\n      where: { id: userId },\n    });\n  }\n\n  async saveRefreshToken(userId: string, refreshToken: string) {\n    return prisma.refreshToken.upsert({\n      where: { userId },\n      update: { token: refreshToken },\n      create: { userId, token: refreshToken },\n    });\n  }\n\n  async findRefreshToken(userId: string) {\n    const tokenRecord = await prisma.refreshToken.findUnique({\n      where: { userId },\n    });\n    return tokenRecord?.token || null;\n  }\n}\n\nexport const authRepository = new AuthRepository();\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAA6B;AAC7B,oBAAmB;AAEnB,IAAM,SAAS,IAAI,2BAAa;AAEzB,IAAM,iBAAN,MAAqB;AAAA,EAC1B,MAAM,WAAW,EAAE,UAAU,OAAO,SAAS,GAA0D;AACrG,UAAM,iBAAiB,MAAM,cAAAA,QAAO,KAAK,UAAU,EAAE;AACrD,WAAO,OAAO,KAAK,OAAO;AAAA,MACxB,MAAM;AAAA,QACJ;AAAA,QACA;AAAA,QACA,UAAU;AAAA,MACZ;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,mBAAmB,UAAkB;AACzC,WAAO,OAAO,KAAK,WAAW;AAAA,MAC5B,OAAO,EAAE,SAAS;AAAA,IACpB,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,aAAa,QAAgB;AACjC,WAAO,OAAO,KAAK,WAAW;AAAA,MAC5B,OAAO,EAAE,IAAI,OAAO;AAAA,IACtB,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,iBAAiB,QAAgB,cAAsB;AAC3D,WAAO,OAAO,aAAa,OAAO;AAAA,MAChC,OAAO,EAAE,OAAO;AAAA,MAChB,QAAQ,EAAE,OAAO,aAAa;AAAA,MAC9B,QAAQ,EAAE,QAAQ,OAAO,aAAa;AAAA,IACxC,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,iBAAiB,QAAgB;AACrC,UAAM,cAAc,MAAM,OAAO,aAAa,WAAW;AAAA,MACvD,OAAO,EAAE,OAAO;AAAA,IAClB,CAAC;AACD,WAAO,aAAa,SAAS;AAAA,EAC/B;AACF;AAEO,IAAM,iBAAiB,IAAI,eAAe;","names":["bcrypt"]}